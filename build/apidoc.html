<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/localnerve/html-snapshots"

    >html-snapshots (v0.14.0)</a>
</h1>
<h4>A selector-based html snapshot tool using PhantomJS that sources sitemap.xml, robots.txt, or arbitrary input</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots">module html-snapshots</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.run">
            function <span class="apidocSignatureSpan">html-snapshots.</span>run
            <span class="apidocSignatureSpan">(options, listener)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>_base</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>array</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>html_snapshots</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>robots</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>sitemap</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">html-snapshots.</span>textfile</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots._base">module html-snapshots._base</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.EOI">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>EOI
            <span class="apidocSignatureSpan">(generator)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.defaults">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>defaults
            <span class="apidocSignatureSpan">(specific)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.generatorError">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>generatorError
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.input">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>input
            <span class="apidocSignatureSpan">(options, page)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.outputFile">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>outputFile
            <span class="apidocSignatureSpan">(options, page, parse)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots._base.run">
            function <span class="apidocSignatureSpan">html-snapshots._base.</span>run
            <span class="apidocSignatureSpan">(options, generator, listener)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots.array">module html-snapshots.array</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.array.run">
            function <span class="apidocSignatureSpan">html-snapshots.array.</span>run
            <span class="apidocSignatureSpan">(options, listener)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots.html_snapshots">module html-snapshots.html_snapshots</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.html_snapshots.run">
            function <span class="apidocSignatureSpan">html-snapshots.html_snapshots.</span>run
            <span class="apidocSignatureSpan">(options, listener)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots.robots">module html-snapshots.robots</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.robots.run">
            function <span class="apidocSignatureSpan">html-snapshots.robots.</span>run
            <span class="apidocSignatureSpan">(options, listener)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots.sitemap">module html-snapshots.sitemap</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.sitemap.getFile">
            function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>getFile
            <span class="apidocSignatureSpan">(options, parseFn, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.sitemap.getUrl">
            function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>getUrl
            <span class="apidocSignatureSpan">(options, parseFn, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.sitemap.parse">
            function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>parse
            <span class="apidocSignatureSpan">(options, document, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.sitemap.stillCurrent">
            function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>stillCurrent
            <span class="apidocSignatureSpan">(urlNode, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.html-snapshots.textfile">module html-snapshots.textfile</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.html-snapshots.textfile.run">
            function <span class="apidocSignatureSpan">html-snapshots.textfile.</span>run
            <span class="apidocSignatureSpan">(options, listener)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots" id="apidoc.module.html-snapshots">module html-snapshots</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.run" id="apidoc.element.html-snapshots.run">
        function <span class="apidocSignatureSpan">html-snapshots.</span>run
        <span class="apidocSignatureSpan">(options, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, listener) {
  var inputGenerator, notifier, started, result, q, emitter, completion;

  options = options || {};
  prepOptions(options);

  // create the inputGenerator, default to robots
  inputGenerator = inputFactory.create(options.input);

  // clean the snapshot output directory
  if (options.outputDirClean) {
    rimraf(options.outputDir);
  }

  // start async completion notification.
  notifier = new Notifier();
  emitter = new EventEmitter();
  started = notifier.start(options.pollInterval, inputGenerator,
    function (err, completed) {
      emitter.emit(&#x22;complete&#x22;, err, completed);
    });

  if (started) {
    // create the completion Promise.
    completion = new Promise(function (resolve, reject) {
      function completionResolver (err, completed) {
        try {
          _.isFunction(listener) &#x26;&#x26; listener(err, completed);
        } catch (e) {
          console.error(&#x22;User supplied listener exception&#x22;, e);
        }
        if (err) {
          err.notCompleted = notifier.filesNotDone;
          err.completed = completed;
          reject(err);
        } else {
          resolve(completed);
        }
      }
      emitter.addListener(&#x22;complete&#x22;, completionResolver);
    });

    // create a worker queue with a parallel process limit.
    q = asyncLib.queue(function (task, callback) {
      task(_.once(callback));
    }, options.processLimit);

    // have the queue call notifier.empty when last item
    //  from the queue is given to a worker.
    q.empty = notifier.qEmpty.bind(notifier);

    // expose abort callback to input generators via options.
    options._abort = function (err) {
      notifier.abort(q, err);
    };

    // generate input for the snapshots.
    result = inputGenerator.run(options, function (input) {
      // give the worker the input and place into the queue
      q.push(_.partial(worker, input, options, notifier));
    })
      // after input generation, resolve on browser completion.
      .then(function () {
        return completion;
      });
  } else {
    result = Promise.reject(&#x22;failed to start async notifier&#x22;);
  }

  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots._base" id="apidoc.module.html-snapshots._base">module html-snapshots._base</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots._base.EOI" id="apidoc.element.html-snapshots._base.EOI">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>EOI
        <span class="apidocSignatureSpan">(generator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">EOI = function (generator) {
  generator.EOI = function () { return true; };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

return result
  .catch(function (error) {
    options._abort(error);
  })
  .then(function () {
    base.<span class="apidocCodeKeywordSpan">EOI</span>(array);
  });
}

array = module.exports = {
/**
 * Generate the input arguments for snapshots from an array.
 *
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots._base.defaults" id="apidoc.element.html-snapshots._base.defaults">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>defaults
        <span class="apidocSignatureSpan">(specific)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">defaults = function (specific) {
  return Object.assign({}, defaults, specific);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Each input argument generated calls the listener passing the input object.
   *
   * @param {Object} options - Robots options.
   * @param {Function} listener - Callback to receive each input.
   * @returns {Promise} Resolves to undefined on completion.
   */
  run: function (options, listener) {
    var opts = Object.assign({}, base.<span class="apidocCodeKeywordSpan">defaults</span>(defaults), options);

    return base.run(opts, generateInput, listener);
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots._base.generatorError" id="apidoc.element.html-snapshots._base.generatorError">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>generatorError
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generatorError = function () {
  return new Error(&#x22;Failed to generate input&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            auth: url.auth,
            hostname: url.hostname,
            port: url.port
          }),
          urlNode.loc[0])
        ) {
          source = urlNode.loc[0];
          err = base.<span class="apidocCodeKeywordSpan">generatorError</span>();
        }
      }

      return err;
    }
  );
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots._base.input" id="apidoc.element.html-snapshots._base.input">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>input
        <span class="apidocSignatureSpan">(options, page)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">input = function (options, page) {
  var parse = {};
  var outputFile = mapOutputFile(options, page, parse);

  if (outputFile) {

    options._inputEmitter.emit(&#x22;input&#x22;, {
      outputFile: outputFile,
      // make the url
      url: urlm.format({
              protocol: options.protocol,
              auth: options.auth,
              hostname: options.hostname,
              port: options.port,
              pathname: parse.url.pathname,
              search: parse.url.search,
              hash: parse.url.hash
            }),
      // map the input page to a selector
      selector: options.selector(page),
      // map the input page to a timeout
      timeout: options.timeout(page),
      checkInterval: options.checkInterval,
      // map the input page to a useJQuery flag
      useJQuery: options.useJQuery(page),
      // map the input page to a verbose flag
      verbose: options.verbose(page),
      // map the input page to phantomJS options
      phantomjsOptions: options.phantomjsOptions(page),
      // useful for testing, debugging
      __page: page
    });

  }

  return outputFile;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var url,
    process = !options.sitemapPolicy ||
      !stillCurrent(urlNode, options);

if (process) {
  // if sitemap is malformed, just blow up
  url = urlm.parse(urlNode.loc[0]);
  if (!base.<span class="apidocCodeKeywordSpan">input</span>(_.extend({}, options, {
      protocol: url.protocol,
      auth: url.auth,
      hostname: url.hostname,
      port: url.port
    }),
    urlNode.loc[0])
  ) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots._base.outputFile" id="apidoc.element.html-snapshots._base.outputFile">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>outputFile
        <span class="apidocSignatureSpan">(options, page, parse)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function mapOutputFile(options, page, parse) {
  if (!_.isFunction(options.outputPath)) {
    options.outputPath = normalize(options.outputPath);
  }

  var outputPath = getOutputPath(options, page, parse);
  var outputDir = options.outputDir;
  var fileName = &#x22;index.html&#x22;;

  if (options.sitemapOutputDir) {
    outputDir = path.join(options.outputDir, options.sitemapOutputDir);
    fileName = &#x22;&#x22;;
  }

  return ( outputPath &#x26;&#x26; path.join(outputDir, outputPath, fileName) ) || false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var now = Date.now();
var lMod = _.first(urlNode.lastmod);
var cFreq = _.first(urlNode.changefreq) ? _.first(urlNode.changefreq).toLowerCase() : null;

// only lastmod specified
if (lMod &#x26;&#x26; !cFreq) {
  // if sitemap is malformed, just blow up
  oPath = base.<span class="apidocCodeKeywordSpan">outputFile</span>(options, urlNode.loc[0]);

  lesser = now - ( (fs.existsSync(oPath) &#x26;&#x26; fs.statSync(oPath).mtime.getTime()) || unixStart );
  greater = now - Date.parse(lMod);
}
// only changefreq specified
else if (!lMod &#x26;&#x26; cFreq) {
  // if sitemap is malformed, just blow up
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots._base.run" id="apidoc.element.html-snapshots._base.run">
        function <span class="apidocSignatureSpan">html-snapshots._base.</span>run
        <span class="apidocSignatureSpan">(options, generator, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, generator, listener) {
  options = options || {};
  prepOptions(options, listener);
  return generator(options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots.array" id="apidoc.module.html-snapshots.array">module html-snapshots.array</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.array.run" id="apidoc.element.html-snapshots.array.run">
        function <span class="apidocSignatureSpan">html-snapshots.array.</span>run
        <span class="apidocSignatureSpan">(options, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, listener) {
  return base.run(options, generateInput, listener);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots.html_snapshots" id="apidoc.module.html-snapshots.html_snapshots">module html-snapshots.html_snapshots</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.html_snapshots.run" id="apidoc.element.html-snapshots.html_snapshots.run">
        function <span class="apidocSignatureSpan">html-snapshots.html_snapshots.</span>run
        <span class="apidocSignatureSpan">(options, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, listener) {
  var inputGenerator, notifier, started, result, q, emitter, completion;

  options = options || {};
  prepOptions(options);

  // create the inputGenerator, default to robots
  inputGenerator = inputFactory.create(options.input);

  // clean the snapshot output directory
  if (options.outputDirClean) {
    rimraf(options.outputDir);
  }

  // start async completion notification.
  notifier = new Notifier();
  emitter = new EventEmitter();
  started = notifier.start(options.pollInterval, inputGenerator,
    function (err, completed) {
      emitter.emit(&#x22;complete&#x22;, err, completed);
    });

  if (started) {
    // create the completion Promise.
    completion = new Promise(function (resolve, reject) {
      function completionResolver (err, completed) {
        try {
          _.isFunction(listener) &#x26;&#x26; listener(err, completed);
        } catch (e) {
          console.error(&#x22;User supplied listener exception&#x22;, e);
        }
        if (err) {
          err.notCompleted = notifier.filesNotDone;
          err.completed = completed;
          reject(err);
        } else {
          resolve(completed);
        }
      }
      emitter.addListener(&#x22;complete&#x22;, completionResolver);
    });

    // create a worker queue with a parallel process limit.
    q = asyncLib.queue(function (task, callback) {
      task(_.once(callback));
    }, options.processLimit);

    // have the queue call notifier.empty when last item
    //  from the queue is given to a worker.
    q.empty = notifier.qEmpty.bind(notifier);

    // expose abort callback to input generators via options.
    options._abort = function (err) {
      notifier.abort(q, err);
    };

    // generate input for the snapshots.
    result = inputGenerator.run(options, function (input) {
      // give the worker the input and place into the queue
      q.push(_.partial(worker, input, options, notifier));
    })
      // after input generation, resolve on browser completion.
      .then(function () {
        return completion;
      });
  } else {
    result = Promise.reject(&#x22;failed to start async notifier&#x22;);
  }

  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots.robots" id="apidoc.module.html-snapshots.robots">module html-snapshots.robots</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.robots.run" id="apidoc.element.html-snapshots.robots.run">
        function <span class="apidocSignatureSpan">html-snapshots.robots.</span>run
        <span class="apidocSignatureSpan">(options, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, listener) {
  var opts = Object.assign({}, base.defaults(defaults), options);

  return base.run(opts, generateInput, listener);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots.sitemap" id="apidoc.module.html-snapshots.sitemap">module html-snapshots.sitemap</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.sitemap.getFile" id="apidoc.element.html-snapshots.sitemap.getFile">
        function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>getFile
        <span class="apidocSignatureSpan">(options, parseFn, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getFile(options, parseFn, callback) {
  fs.readFile(options.source, function (err, data) {
    if (err) {
      callback(common.prependMsgToErr(err, options.source, true));
    } else {
      convert(options, data, parseFn, callback);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots.sitemap.getUrl" id="apidoc.element.html-snapshots.sitemap.getUrl">
        function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>getUrl
        <span class="apidocSignatureSpan">(options, parseFn, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getUrl(options, parseFn, callback) {
  request({
    url: options.source,
    encoding: null,
    timeout: options.timeout() // get the default timeout
  }, function (err, res, body) {
    var error = err || common.checkResponse(res, [&#x22;text/xml&#x22;, &#x22;application/xml&#x22;]);

    if (error) {
      callback(common.prependMsgToErr(error, options.source, true));
    } else {
      convert(options, body, parseFn, callback);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots.sitemap.parse" id="apidoc.element.html-snapshots.sitemap.parse">
        function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>parse
        <span class="apidocSignatureSpan">(options, document, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function parse(options, document, callback) {
  xml2js.parseString(document, {
    trim: true,
    normalizeTags: true,
    normalize: true
  }, function (err, result) {
    var source = options.source;

    if (!err) {

      // Process the url input, but break if base.input returns false.
      //   In other words, _.find is looking for a non-falsy err.
      // For now, this can only happen if no outputDir is defined,
      //   which is a fatal bad option problem and will happen immediately.
      _.find(
        // if the sitemap is malformed, just blow up
        result.urlset.url,
        function (urlNode) {
          // optionally ignore current urls by sitemap policy
          var url,
              process = !options.sitemapPolicy ||
                !stillCurrent(urlNode, options);

          if (process) {
            // if sitemap is malformed, just blow up
            url = urlm.parse(urlNode.loc[0]);
            if (!base.input(_.extend({}, options, {
                protocol: url.protocol,
                auth: url.auth,
                hostname: url.hostname,
                port: url.port
              }),
              urlNode.loc[0])
            ) {
              source = urlNode.loc[0];
              err = base.generatorError();
            }
          }

          return err;
        }
      );
    }

    callback(common.prependMsgToErr(err, source, true));
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  // only lastmod specified
  if (lMod &#x26;&#x26; !cFreq) {
// if sitemap is malformed, just blow up
oPath = base.outputFile(options, urlNode.loc[0]);

lesser = now - ( (fs.existsSync(oPath) &#x26;&#x26; fs.statSync(oPath).mtime.getTime()) || unixStart );
greater = now - Date.<span class="apidocCodeKeywordSpan">parse</span>(lMod);
  }
  // only changefreq specified
  else if (!lMod &#x26;&#x26; cFreq) {
// if sitemap is malformed, just blow up
oPath = base.outputFile(options, urlNode.loc[0]);

lesser = now - ( (fs.existsSync(oPath) &#x26;&#x26; fs.statSync(oPath).mtime.getTime()) || unixStart );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.html-snapshots.sitemap.stillCurrent" id="apidoc.element.html-snapshots.sitemap.stillCurrent">
        function <span class="apidocSignatureSpan">html-snapshots.sitemap.</span>stillCurrent
        <span class="apidocSignatureSpan">(urlNode, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stillCurrent(urlNode, options) {
  var lesser, greater, oPath;
  var now = Date.now();
  var lMod = _.first(urlNode.lastmod);
  var cFreq = _.first(urlNode.changefreq) ? _.first(urlNode.changefreq).toLowerCase() : null;

  // only lastmod specified
  if (lMod &#x26;&#x26; !cFreq) {
    // if sitemap is malformed, just blow up
    oPath = base.outputFile(options, urlNode.loc[0]);

    lesser = now - ( (fs.existsSync(oPath) &#x26;&#x26; fs.statSync(oPath).mtime.getTime()) || unixStart );
    greater = now - Date.parse(lMod);
  }
  // only changefreq specified
  else if (!lMod &#x26;&#x26; cFreq) {
    // if sitemap is malformed, just blow up
    oPath = base.outputFile(options, urlNode.loc[0]);

    lesser = now - ( (fs.existsSync(oPath) &#x26;&#x26; fs.statSync(oPath).mtime.getTime()) || unixStart );
    greater = changeFreq[cFreq] || changeFreq.always;
  }
  // both or neither were specified
  else {
    lesser = now - Date.parse(lMod || unixStart);
    greater = changeFreq[cFreq] || changeFreq.always;
  }

  return lesser &#x3c;= greater;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.html-snapshots.textfile" id="apidoc.module.html-snapshots.textfile">module html-snapshots.textfile</a></h1>


    <h2>
        <a href="#apidoc.element.html-snapshots.textfile.run" id="apidoc.element.html-snapshots.textfile.run">
        function <span class="apidocSignatureSpan">html-snapshots.textfile.</span>run
        <span class="apidocSignatureSpan">(options, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, listener) {
  var opts = Object.assign({}, base.defaults(defaults), options);

  return base.run(opts, generateInput, listener);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
A growing showcase of runnable examples can be found [here](/examples).

An older (version 0.13.2), more in depth usage example is located in this [article](/docs/example-heroku-redis.md) that includes
 explanation and code of a real usage featuring dynamic app routes, ExpressJS, Heroku, and more.

### Simple example
```javascript
var htmlSnapshots = require(&#x27;html-snapshots&#x27;);
htmlSnapshots.<span class="apidocCodeKeywordSpan">run</span>({
  source: &#x22;/path/to/robots.txt&#x22;,
  hostname: &#x22;exampledomain.com&#x22;,
  outputDir: &#x22;./snapshots&#x22;,
  outputDirClean: true,
  selector: &#x22;#dynamic-content&#x22;
})
.then(function (completed) {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
